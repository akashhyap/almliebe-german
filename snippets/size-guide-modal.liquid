{% comment %}
  SIZE GUIDE MODAL - Trachten-specific sizing
  
  Includes:
  - Dirndl sizing (bust-focused)
  - Lederhosen sizing (waist/inseam)
  - General German sizing
  - How to measure guide
{% endcomment %}

<div class="size-guide">
  <h2 class="size-guide__title">{{ 'products.size_guide.title' | t | default: 'Größentabelle' }}</h2>
  
  {%- comment -%} Tabs for different product types {%- endcomment -%}
  <div class="size-guide__tabs">
    <button type="button" class="size-guide__tab is-active" data-size-tab="dirndl">Dirndl</button>
    <button type="button" class="size-guide__tab" data-size-tab="lederhosen">Lederhosen</button>
    <button type="button" class="size-guide__tab" data-size-tab="damen">Damen</button>
    <button type="button" class="size-guide__tab" data-size-tab="herren">Herren</button>
    <button type="button" class="size-guide__tab" data-size-tab="kinder">Kinder</button>
  </div>

  {%- comment -%} Dirndl Size Chart {%- endcomment -%}
  <div class="size-guide__panel is-active" data-size-panel="dirndl">
    <p class="size-guide__intro">
      {{ 'products.size_guide.dirndl_intro' | t | default: 'Bei Dirndl ist die Brustweite das wichtigste Maß. Messen Sie direkt unter der Brust um den Körper herum.' }}
    </p>
    
    <div class="size-guide__table-wrapper">
      <table class="size-guide__table">
        <thead>
          <tr>
            <th>{{ 'products.size_guide.size' | t | default: 'Größe' }}</th>
            <th>DE</th>
            <th>{{ 'products.size_guide.bust' | t | default: 'Brustumfang' }} (cm)</th>
            <th>{{ 'products.size_guide.waist' | t | default: 'Taillenumfang' }} (cm)</th>
            <th>{{ 'products.size_guide.hips' | t | default: 'Hüftumfang' }} (cm)</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>XS</td><td>32</td><td>76-80</td><td>58-62</td><td>84-88</td></tr>
          <tr><td>S</td><td>34</td><td>80-84</td><td>62-66</td><td>88-92</td></tr>
          <tr><td>S/M</td><td>36</td><td>84-88</td><td>66-70</td><td>92-96</td></tr>
          <tr><td>M</td><td>38</td><td>88-92</td><td>70-74</td><td>96-100</td></tr>
          <tr><td>M/L</td><td>40</td><td>92-96</td><td>74-78</td><td>100-104</td></tr>
          <tr><td>L</td><td>42</td><td>96-100</td><td>78-82</td><td>104-108</td></tr>
          <tr><td>L/XL</td><td>44</td><td>100-104</td><td>82-86</td><td>108-112</td></tr>
          <tr><td>XL</td><td>46</td><td>104-110</td><td>86-92</td><td>112-118</td></tr>
          <tr><td>XXL</td><td>48</td><td>110-116</td><td>92-98</td><td>118-124</td></tr>
          <tr><td>3XL</td><td>50</td><td>116-122</td><td>98-104</td><td>124-130</td></tr>
          <tr><td>4XL</td><td>52</td><td>122-128</td><td>104-110</td><td>130-136</td></tr>
        </tbody>
      </table>
    </div>

    <div class="size-guide__tip">
      <strong>{{ 'products.size_guide.tip' | t | default: 'Tipp' }}:</strong>
      {{ 'products.size_guide.dirndl_tip' | t | default: 'Bei Zwischengrößen empfehlen wir die größere Größe zu wählen, da sich ein Dirndl durch die Schnürung im Rücken anpassen lässt.' }}
    </div>

    <h4>{{ 'products.size_guide.dirndl_lengths' | t | default: 'Dirndl-Längen' }}</h4>
    <ul class="size-guide__lengths">
      <li><strong>Mini:</strong> {{ 'products.size_guide.mini_length' | t | default: '50-60 cm (endet oberhalb des Knies)' }}</li>
      <li><strong>Midi:</strong> {{ 'products.size_guide.midi_length' | t | default: '60-70 cm (endet am Knie)' }}</li>
      <li><strong>Lang:</strong> {{ 'products.size_guide.lang_length' | t | default: '90-100 cm (endet unterhalb des Knies)' }}</li>
    </ul>
  </div>

  {%- comment -%} Lederhosen Size Chart {%- endcomment -%}
  <div class="size-guide__panel" data-size-panel="lederhosen">
    <p class="size-guide__intro">
      {{ 'products.size_guide.lederhosen_intro' | t | default: 'Bei Lederhosen sind Bundweite und Schrittlänge die wichtigsten Maße. Lederhosen dehnen sich mit der Zeit etwas.' }}
    </p>
    
    <div class="size-guide__table-wrapper">
      <table class="size-guide__table">
        <thead>
          <tr>
            <th>{{ 'products.size_guide.size' | t | default: 'Größe' }}</th>
            <th>{{ 'products.size_guide.waist' | t | default: 'Bundweite' }} (cm)</th>
            <th>{{ 'products.size_guide.inseam_short' | t | default: 'Kurz' }} (cm)</th>
            <th>{{ 'products.size_guide.inseam_knee' | t | default: 'Kniebund' }} (cm)</th>
            <th>{{ 'products.size_guide.inseam_long' | t | default: 'Lang' }} (cm)</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>44</td><td>72-76</td><td>32-34</td><td>55-58</td><td>78-82</td></tr>
          <tr><td>46</td><td>76-80</td><td>33-35</td><td>56-59</td><td>80-84</td></tr>
          <tr><td>48</td><td>80-84</td><td>34-36</td><td>57-60</td><td>82-86</td></tr>
          <tr><td>50</td><td>84-88</td><td>35-37</td><td>58-61</td><td>84-88</td></tr>
          <tr><td>52</td><td>88-92</td><td>36-38</td><td>59-62</td><td>86-90</td></tr>
          <tr><td>54</td><td>92-96</td><td>37-39</td><td>60-63</td><td>88-92</td></tr>
          <tr><td>56</td><td>96-100</td><td>38-40</td><td>61-64</td><td>90-94</td></tr>
          <tr><td>58</td><td>100-104</td><td>39-41</td><td>62-65</td><td>92-96</td></tr>
          <tr><td>60</td><td>104-110</td><td>40-42</td><td>63-66</td><td>94-98</td></tr>
          <tr><td>62</td><td>110-116</td><td>41-43</td><td>64-67</td><td>96-100</td></tr>
        </tbody>
      </table>
    </div>

    <div class="size-guide__tip">
      <strong>{{ 'products.size_guide.tip' | t | default: 'Tipp' }}:</strong>
      {{ 'products.size_guide.lederhosen_tip' | t | default: 'Neue Lederhosen sollten eng sitzen. Nach einigen Stunden Tragen passt sich das Leder an Ihre Körperform an.' }}
    </div>
  </div>

  {%- comment -%} Damen Size Chart {%- endcomment -%}
  <div class="size-guide__panel" data-size-panel="damen">
    <p class="size-guide__intro">
      {{ 'products.size_guide.damen_intro' | t | default: 'Allgemeine Größentabelle für Damen-Trachtenbekleidung wie Blusen, Strickjacken und Mieder.' }}
    </p>
    
    <div class="size-guide__table-wrapper">
      <table class="size-guide__table">
        <thead>
          <tr>
            <th>Int.</th>
            <th>DE</th>
            <th>{{ 'products.size_guide.bust' | t | default: 'Brust' }} (cm)</th>
            <th>{{ 'products.size_guide.waist' | t | default: 'Taille' }} (cm)</th>
            <th>{{ 'products.size_guide.hips' | t | default: 'Hüfte' }} (cm)</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>XS</td><td>32-34</td><td>76-84</td><td>58-66</td><td>84-92</td></tr>
          <tr><td>S</td><td>36-38</td><td>84-92</td><td>66-74</td><td>92-100</td></tr>
          <tr><td>M</td><td>40-42</td><td>92-100</td><td>74-82</td><td>100-108</td></tr>
          <tr><td>L</td><td>44-46</td><td>100-110</td><td>82-92</td><td>108-118</td></tr>
          <tr><td>XL</td><td>48-50</td><td>110-122</td><td>92-104</td><td>118-130</td></tr>
          <tr><td>XXL</td><td>52-54</td><td>122-134</td><td>104-116</td><td>130-142</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  {%- comment -%} Herren Size Chart {%- endcomment -%}
  <div class="size-guide__panel" data-size-panel="herren">
    <p class="size-guide__intro">
      {{ 'products.size_guide.herren_intro' | t | default: 'Allgemeine Größentabelle für Herren-Trachtenbekleidung wie Hemden, Westen und Janker.' }}
    </p>
    
    <div class="size-guide__table-wrapper">
      <table class="size-guide__table">
        <thead>
          <tr>
            <th>Int.</th>
            <th>DE</th>
            <th>{{ 'products.size_guide.chest' | t | default: 'Brust' }} (cm)</th>
            <th>{{ 'products.size_guide.waist' | t | default: 'Taille' }} (cm)</th>
            <th>{{ 'products.size_guide.collar' | t | default: 'Kragenweite' }} (cm)</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>XS</td><td>44</td><td>86-89</td><td>74-77</td><td>37-38</td></tr>
          <tr><td>S</td><td>46-48</td><td>90-97</td><td>78-85</td><td>39-40</td></tr>
          <tr><td>M</td><td>50-52</td><td>98-105</td><td>86-93</td><td>41-42</td></tr>
          <tr><td>L</td><td>54-56</td><td>106-113</td><td>94-101</td><td>43-44</td></tr>
          <tr><td>XL</td><td>58-60</td><td>114-121</td><td>102-109</td><td>45-46</td></tr>
          <tr><td>XXL</td><td>62-64</td><td>122-129</td><td>110-117</td><td>47-48</td></tr>
          <tr><td>3XL</td><td>66-68</td><td>130-137</td><td>118-125</td><td>49-50</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  {%- comment -%} Kinder Size Chart {%- endcomment -%}
  <div class="size-guide__panel" data-size-panel="kinder">
    <p class="size-guide__intro">
      {{ 'products.size_guide.kinder_intro' | t | default: 'Kinderkleidung wird nach Körpergröße in cm angegeben.' }}
    </p>
    
    <div class="size-guide__table-wrapper">
      <table class="size-guide__table">
        <thead>
          <tr>
            <th>{{ 'products.size_guide.size' | t | default: 'Größe' }}</th>
            <th>{{ 'products.size_guide.height' | t | default: 'Körpergröße' }} (cm)</th>
            <th>{{ 'products.size_guide.age' | t | default: 'Alter (ca.)' }}</th>
            <th>{{ 'products.size_guide.chest' | t | default: 'Brust' }} (cm)</th>
            <th>{{ 'products.size_guide.waist' | t | default: 'Taille' }} (cm)</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>86/92</td><td>86-92</td><td>1-2 Jahre</td><td>52-54</td><td>50-51</td></tr>
          <tr><td>98/104</td><td>98-104</td><td>3-4 Jahre</td><td>55-57</td><td>52-53</td></tr>
          <tr><td>110/116</td><td>110-116</td><td>5-6 Jahre</td><td>58-61</td><td>54-56</td></tr>
          <tr><td>122/128</td><td>122-128</td><td>7-8 Jahre</td><td>62-66</td><td>57-59</td></tr>
          <tr><td>134/140</td><td>134-140</td><td>9-10 Jahre</td><td>67-72</td><td>60-63</td></tr>
          <tr><td>146/152</td><td>146-152</td><td>11-12 Jahre</td><td>73-78</td><td>64-67</td></tr>
          <tr><td>158/164</td><td>158-164</td><td>13-14 Jahre</td><td>79-84</td><td>68-71</td></tr>
          <tr><td>170/176</td><td>170-176</td><td>15-16 Jahre</td><td>85-92</td><td>72-76</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  {%- comment -%} How to Measure {%- endcomment -%}
  <div class="size-guide__measure">
    <h3>{{ 'products.size_guide.how_to_measure' | t | default: 'So messen Sie richtig' }}</h3>
    
    <div class="size-guide__measure-grid">
      <div class="size-guide__measure-item">
        <div class="size-guide__measure-icon">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="12" cy="8" r="4"/><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
            <path d="M5 11h14" stroke-dasharray="2 2"/>
          </svg>
        </div>
        <h4>{{ 'products.size_guide.bust' | t | default: 'Brustumfang' }}</h4>
        <p>{{ 'products.size_guide.bust_instruction' | t | default: 'Messen Sie an der stärksten Stelle der Brust horizontal um den Körper.' }}</p>
      </div>

      <div class="size-guide__measure-item">
        <div class="size-guide__measure-icon">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="12" cy="8" r="4"/><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
            <path d="M5 14h14" stroke-dasharray="2 2"/>
          </svg>
        </div>
        <h4>{{ 'products.size_guide.waist' | t | default: 'Taillenumfang' }}</h4>
        <p>{{ 'products.size_guide.waist_instruction' | t | default: 'Messen Sie an der schmalsten Stelle der Taille, etwa auf Bauchnabelhöhe.' }}</p>
      </div>

      <div class="size-guide__measure-item">
        <div class="size-guide__measure-icon">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="12" cy="8" r="4"/><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
            <path d="M5 17h14" stroke-dasharray="2 2"/>
          </svg>
        </div>
        <h4>{{ 'products.size_guide.hips' | t | default: 'Hüftumfang' }}</h4>
        <p>{{ 'products.size_guide.hips_instruction' | t | default: 'Messen Sie an der breitesten Stelle der Hüfte, etwa 20 cm unter der Taille.' }}</p>
      </div>
    </div>
  </div>

  {%- comment -%} Kiwi Sizing Integration Hook {%- endcomment -%}
  {%- if settings.enable_kiwi_sizing -%}
    <div class="size-guide__kiwi">
      <p>{{ 'products.size_guide.find_your_size' | t | default: 'Unsicher bei der Größe?' }}</p>
      <button type="button" class="btn btn--primary" data-kiwi-size-chart>
        {{ 'products.size_guide.use_size_finder' | t | default: 'Größenberater starten' }}
      </button>
    </div>
  {%- endif -%}

  {%- comment -%} Contact Help {%- endcomment -%}
  <div class="size-guide__help">
    <p>{{ 'products.size_guide.need_help' | t | default: 'Sie benötigen Hilfe bei der Größenwahl?' }}</p>
    <a href="mailto:{{ shop.email }}">{{ 'products.size_guide.contact_us' | t | default: 'Kontaktieren Sie uns' }}</a>
  </div>
</div>

<style>
  .size-guide {
    padding: 1rem 0;
  }

  .size-guide__title {
    font-size: 1.5rem;
    margin: 0 0 1.5rem;
    text-align: center;
  }

  .size-guide__tabs {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
    border-bottom: 1px solid var(--color-border);
    padding-bottom: 0.5rem;
  }

  .size-guide__tab {
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-text-secondary);
    background: none;
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: all 0.2s;
  }

  .size-guide__tab.is-active,
  .size-guide__tab:hover {
    color: var(--color-primary);
    background: rgba(30, 86, 49, 0.1);
  }

  .size-guide__panel {
    display: none;
  }

  .size-guide__panel.is-active {
    display: block;
  }

  .size-guide__intro {
    font-size: 0.9375rem;
    color: var(--color-text-secondary);
    margin-bottom: 1.25rem;
  }

  .size-guide__table-wrapper {
    overflow-x: auto;
    margin-bottom: 1.25rem;
  }

  .size-guide__table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.875rem;
  }

  .size-guide__table th,
  .size-guide__table td {
    padding: 0.75rem;
    text-align: center;
    border: 1px solid var(--color-border);
  }

  .size-guide__table th {
    background: var(--color-background);
    font-weight: 600;
    white-space: nowrap;
  }

  .size-guide__table tbody tr:hover {
    background: rgba(30, 86, 49, 0.05);
  }

  .size-guide__tip {
    padding: 1rem;
    background: rgba(200, 169, 106, 0.15);
    border-left: 3px solid var(--color-accent);
    border-radius: var(--border-radius);
    font-size: 0.875rem;
    margin-bottom: 1.5rem;
  }

  .size-guide__lengths {
    list-style: none;
    padding: 0;
    margin: 0.75rem 0 1.5rem;
  }

  .size-guide__lengths li {
    padding: 0.5rem 0;
    font-size: 0.9375rem;
    border-bottom: 1px solid var(--color-border);
  }

  .size-guide__lengths li:last-child {
    border-bottom: none;
  }

  .size-guide__measure {
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid var(--color-border);
  }

  .size-guide__measure h3 {
    font-size: 1.125rem;
    margin-bottom: 1.25rem;
  }

  .size-guide__measure-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 1.5rem;
  }

  .size-guide__measure-item {
    text-align: center;
  }

  .size-guide__measure-icon {
    width: 60px;
    height: 60px;
    margin: 0 auto 0.75rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-background);
    border-radius: 50%;
    color: var(--color-primary);
  }

  .size-guide__measure-item h4 {
    font-size: 0.9375rem;
    margin-bottom: 0.5rem;
  }

  .size-guide__measure-item p {
    font-size: 0.8125rem;
    color: var(--color-text-secondary);
    margin: 0;
  }

  .size-guide__kiwi {
    margin-top: 2rem;
    padding: 1.5rem;
    text-align: center;
    background: var(--color-background);
    border-radius: var(--border-radius);
  }

  .size-guide__kiwi p {
    margin-bottom: 1rem;
    font-size: 0.9375rem;
  }

  .size-guide__help {
    margin-top: 1.5rem;
    text-align: center;
    font-size: 0.875rem;
    color: var(--color-text-secondary);
  }

  .size-guide__help a {
    color: var(--color-primary);
    font-weight: 500;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const tabs = document.querySelectorAll('[data-size-tab]');
    const panels = document.querySelectorAll('[data-size-panel]');

    tabs.forEach(tab => {
      tab.addEventListener('click', function() {
        const target = this.dataset.sizeTab;

        tabs.forEach(t => t.classList.remove('is-active'));
        panels.forEach(p => p.classList.remove('is-active'));

        this.classList.add('is-active');
        document.querySelector(`[data-size-panel="${target}"]`)?.classList.add('is-active');
      });
    });
  });
</script>
